# オイラー積分入門(1) ガンマ積分

　特殊関数 *special function* というと膨大な数がある。うちに整数環 *integer ring* にまつわるものがリーマン・ゼータ関数 *riemann zeta function* である。多くは変数に現れる積分を扱う。ただし，ごく細いところにある積分を数値化するのはさほど容易なことではない。  
　特殊関数の研究が盛んだったころの数学界では複素解析や整数論が果敢に言及されてきた。ごく細い積分を拡張的に見て，複素解析の手続きでこれを研究材料にするという方法もあった。これが「解析接続 *analytic continuation* 」である。これは，複素解析学について多大な貢献をしたG.F.R.リーマンの代表的な手続きである。リーマン・ゼータ関数はオイラーが示したオイラー・ゼータ関数 *euler zeta function* を解析接続した(つまり複素数に拡張した)ものである。この学問は偏微分 *partial differential* と言えよう。  
　また逆に，言語のプリミティブ型では捉えきれないほどの巨大な数値が簡単に跳ね上がるような無限乗積の極限もある。この無限乗積の極限こそがL.オイラーのガンマ関数 *euler gamma function* である。  
　オイラーのガンマ関数といえば代表的な特殊関数であるが，初歩的な解析学，一般な整数論もあるので，“上位な初等関数”と裏付けるのは至極容易なのである。  
　オイラーは，まず次式  

$$
\begin{array}{rcl}
\Gamma(z) & = & \displaystyle\lim_{n \to \infty}\frac{n!\quad n^{z-1}}{z(z+1)(z+2)\cdots(z+n-1)} \\
 & = & \frac{1}{z}\displaystyle\prod_{n=1}^{\infty}(1+\frac{1}{n})^z(1+\frac{z}{n})^{-1}
\end{array}
$$
  
　のように関数を定義した。  

　今日にガンマ関数と呼ばれる積分をオイラーが発見するに至った動機は，通常は自然数$n$に対して定義される階乗$n!$を，自然数ではない場合にも拡張しようとする試みにあった。この乗積はA.M.ルジャンドルによって第二種オイラー積分 *euler integral the 2nd kind* と呼ばれ，「階乗の一般化」と定義され，広く用いられている。第一種オイラー積分 *euler integral the 1st kind* はガンマ関数に因んでベータ関数 *beta function* と呼ばれる。  
　ベータ関数自体も階乗が因子であるため，このあたりがオイラーが発見する動機に至った箇所でもあるだろう。  
　ガンマ関数は以下のように$n$が従う  

$$\Gamma(n+1)=n!={1}\times{2}\times{3}\times\ldots\times{n}$$

　は無限に拡張される。しかしながら，これはnが正の実数であった場合にあり，負の実数ではまた異なった様子をオイラー積分は持つ。  
　負の実数では$x$が整数であった場合に限り値域は無限複素量 *complex infinity* と一致する。不規則にも見える幾何学であるが，ガンマ関数は指数の極限でもあるので，この性格は仲間である不完全ガンマ関数 *incomplete gamma function* に見えてくる。  

　不完全ガンマ関数は階乗を因子とするファクタ$a$を持ち，このファクタを係数とみなして$x$が従うところのガンマ関数である。これは乗積分のうち$a$は階乗，$x$は指数に帰着する。例えば$a=1$であれば，ガンマ関数は階乗1の指数と一致する。  

$$\Gamma(1,x)=e^{-x}$$

　不完全積分 *incomplete integrals* は積分表示式を区画化したものであり，その振る舞いには単射性が上昇と下降を持つことから，更に上昇傾向のものを第一種 *lower* ，下降傾向のものを第二種 *upper* と冠することが多い。  
　前項の表示式は第二種の不完全ガンマ関数 *incomplete gamma function the 2nd kind* であり，一般には

$$\Gamma(a,x)$$

　と記す。第一種は
 
$$\gamma(a,x)$$

　であり， $y$ 軸で以て $y=0$ を軸に第二種との単射性を反転させる。例えば$a$が1であった場合，以下  

$$\gamma(1,x)=1-e^{-x}$$

　のようになる。  
　減算するところの因子はガンマ関数の$x$とも一致するため，第一種不完全ガンマ関数は  

$$\gamma(a,x)=\Gamma(a)-\Gamma(a,x)$$

　を一般な表示式として用いることも少なくない。一般とはいえ，これは積分区画 $0, x, \infty$ の関係が和積によって示されるのだから，見る尺度からすれば不思議な公式である。  
　階乗が持つ無限乗積とは，その内訳は指数 *exponent* の畳み込み積分 *convolution integral* である。  

　よく知られる階乗関数の導出で，自然数を掛け合わせる式は畳み込み積分の典型例である。  

$1!=1=1$  
$2!={1}\times{2}=2$  
$3!={1}\times{2}\times{3}=6$  
$4!={1}\times{2}\times{3}\times{4}=24$  
$:$  
$:$  

　これゆえガンマ関数は，階乗関数 *factorial function* とも呼ばれる。[^1] 不完全ガンマ関数はこの階乗を係数として区画化していることが「不完全な階乗」を裏付けるものとなっている。したがって，区画化が省かれた一意なものもあり，ガンマ関数のことを完全ガンマ関数 *complete gamma function* ということがある。  

　解析接続の手続きがガンマ関数には表面的なのもあるが，ガンマ関数は本来複素関数 *complex function* である。今日にわれわれが見ている階乗関数としてのガンマ関数は，虚数を省いたものである。  
　これは不完全ガンマ関数には幾何学的な意味合いを持っており，係数$a$が整数だったにつき虚数を持たない。ただ普段には負数の$x$に至ると虚数が現れる。  
　ここで，これを整数のみの別の形として階乗1から3を見てみよう。左からガンマ関数，第二種不完全ガンマ関数，第一種不完全ガンマ関数の順である。  

$$
\begin{matrix}
\Gamma(1)=(1-1)! & \Gamma(1,x)=e^{-x} & \gamma(1,x)=(1-1)!-e^{-x} \\
\Gamma(2)=(2-1)! & \Gamma(2,x)=\frac{e^{-x}(x^2+x)}{x} & \gamma(2,x)=(2-1)!-\frac{e^{-x}(x^2+x)}{x} \\
\Gamma(3)=(3-1)! & \Gamma(3,x)=\frac{e^{-x}(x^3+2x^2+2x)}{x}  & \gamma(3,x)=(3-1)!-\frac{e^{-x}(x^3+2x^2+2x)}{x}
\end{matrix}
$$

　オイラー積分のような整数値それそのものが特殊値 *special value* になるといったそれは，解析学ではさほど珍しい現象ではない。例えばド・モアブルは整数の集合である二項分布 *binomial distribution* の，その極限として正規分布 *normal distribution* を模索した。[^2]解析接続としては複素平面上で超越的な整数の集合をサンプルに見ることがよくあるものなのである。こうした研究的材料には整関数 *entire function* は解析関数として発散しない。しかしながら，このうちに多項式を持たない関数も少なからず存在する。そうした関数のことを超越整関数 *transcendental function* と呼ぶ。  
　この関係は，超越整関数として  

$$\Gamma(z)=\int_{0}^{\infty}t^{z-1}e^{-t}dt,$$

　の公式を満たす。積分の区画化としては  
 
$$\int_{z}^{\infty}t^{a-1}e^{-t}dt,$$

　であり，これは不完全ガンマ関数 $\Gamma(a,z)$ と一致する。  
　また区画化が独立複素変数 $z0$ と独立複素変数 $z1$ の間とした場合がある。これは積分表示式として  
 
$$\int_{z0}^{z1}t^{a-1}e^{-t}dt,$$

　で与えられる，一般化された不完全ガンマ関数 *generalized incomplete gamma function* $\Gamma(a,z0,z1)$ である。  

　解析学としてこれを見ると，階乗関数は不定値がよく発生し，無限複素量がごく普通に表れるため，応用学に使われる例はないに等しい。そこで不定値が発生しないようにと，次式  

$$P(a,z)=\frac{\gamma(a,z)}{\Gamma(a)},\quad Q(a,z)=\frac{\Gamma(a,z)}{\Gamma(a)}$$

　のように定義したものもある。これは正則化された不完全ガンマ関数 *regularized incomplete gamma function* であり，第一種を$P(a,z)$，第二種を$Q(a,z)$とする。  
　正の値は値域を ${0}\le{y}\le{1}$ とすることから，統計累積関数を求めるのによく現れる。  

　ガンマ関数の仲間たちは一般化によるものであって，複雑に見えても簡素なものである。ただ積分表示式の区画化分を正規化させたにある。  
　一般化された不完全ガンマ関数(一般不完全ガンマ関数とも呼ばれる。ここでは一般ガンマ関数と表記)は，不完全ガンマ積分を更に一般化させたもので，確率統計の正規母集団を求めるのに応用事例が多い。  

* 不完全ガンマ関数 *incomplete gamma function*:
  * 第一種: $\gamma(a,z)=\int_0^z e^{-t} t^{a-1} dt, \quad (\mathfrak{Re}(z)>0)$
  * 第二種: $\Gamma(a,z)=\int_z^\infty e^{-t} t^{a-1} dt,$
* 正則不完全ガンマ関数 *regularized incomplete gamma function*:
  * 第一種: $P(a,z)=\gamma(a,z)/\Gamma(a)$
  * 第二種: $Q(a,z)=\Gamma(a,z)/\Gamma(a)$
* 一般ガンマ関数 *generalized incomplete gamma function*:
  * $\Gamma(a,z_0,z_1)=\int_{z_0}^{z_1}t^{a-1} e^{-t} dt,$
* 正則一般ガンマ関数 *regularized generalized incomplete gamma function*:
  * $Q(a,z_0,z_1)=\Gamma(a,z_0,z_1)/\Gamma(a)$

　複素積分が主要根であるため，仲間たちは超越整関数の形を変えたものといえる。  

　代数学的にはガンマ関数は べき級数環 *power series ring* にまつわるため，特異点 *singular point* が存在する。これは通常 $0,\infty$ とする。  
　オイラー積分では実軸上の区間 $(-\infty,0]$ に整数な分枝切断線 *branch cut* を置く。  
　この特異点は実数の簡素な積分計算であるにしろ，変数の現れる定義域以外は複素数値が現れるといった珍しい移り変わりを持っている。しかしながら正の定義域にしか応用学に現れる変数が存在していない。  
　これの代表的な移り変わりは関数等式にあり，特に等式 $\gamma(a,z)+\Gamma(a,z)=\Gamma(a)$ はよく知られている。  

---

> 参考サイト  
> 特殊関数グラフィックスライブラリー  
> Wolfram Research  

[^1]: “実数階乗関数”と呼ぶべきだろうけども。
[^2]: ド・モアブルは正規分布を発見できなかった。C.F.ガウスは最小二乗法を用いて誤差関数を拡張し正規分布を発見した。
